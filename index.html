
    <!DOCTYPE html>
    <html lang="he" dir="rtl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>×¡×§×¨ ×§×•×“×§×•×“ - ×™×™×¦×•× ×œ××§×¡×œ</title>

        <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

        <style>
            :root { --primary: #217346; /* ×™×¨×•×§ ××§×¡×œ */ --bg: #f3f4f6; }
            body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 100px; }

            .main-header {
                background: linear-gradient(135deg, #3949ab 0%, #1e88e5 100%);
                color: white; padding: 30px 20px; text-align: center;
                border-radius: 0 0 25px 25px; margin-bottom: 25px;
            }
            .main-header h1 { margin: 0; font-size: 1.8rem; }
            .main-header h2 { margin: 5px 0 0; font-size: 1rem; opacity: 0.9; font-weight: normal; }

            .container { max-width: 800px; margin: 0 auto; padding: 0 10px; }
            .filter-box {
                background: white; padding: 15px; border-radius: 12px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 10px; z-index: 100;
                border: 1px solid #e0e0e0; margin-bottom: 20px;
            }
            select { width: 100%; padding: 10px; margin: 5px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }

            .student-card {
                background: white; border-radius: 12px; padding: 0; margin-bottom: 20px;
                border: 1px solid #e0e0e0; box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            }
            .student-card.filled { border: 2px solid var(--primary); }

            .card-header {
                display: flex; align-items: center; padding: 15px;
                background-color: #fafafa; border-bottom: 1px solid #eee;
            }
            .student-img {
                width: 60px; height: 60px; border-radius: 50%; object-fit: cover;
                margin-left: 15px; border: 2px solid white; background: #eee;
            }
            .info h3 { margin: 0; font-size: 1.1rem; }

            .rating-section { padding: 15px; }
            .rating-row { margin-bottom: 12px; border-bottom: 1px solid #f9f9f9; padding-bottom: 8px; }
            .rating-label { font-weight: 600; display: block; margin-bottom: 5px; font-size: 0.9rem; }
            .rating-options { display: flex; flex-wrap: wrap; gap: 5px; justify-content: space-between; }

            .radio-group input { display: none; }
            .circle-btn {
                width: 30px; height: 30px; border-radius: 50%;
                background: #f0f0f0; color: #555; display: flex; justify-content: center; align-items: center;
                font-weight: bold; font-size: 14px; border: 1px solid #ddd;
            }
            .na-btn { width: auto; padding: 0 10px; border-radius: 15px; font-size: 12px; }

            input:checked + .circle-btn { background-color: var(--primary); color: white; border-color: var(--primary); }
            input:checked + .na-btn { background-color: #78909c; border-color: #78909c; }

            .note-area { padding: 0 15px 15px; }
            textarea { width: 100%; height: 60px; padding: 10px; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }

            /* ×›×¤×ª×•×¨ ××§×¡×œ ×¦×£ */
            .excel-fab {
                position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
                background-color: #217346; color: white;
                padding: 15px 30px; border-radius: 50px;
                font-size: 1.2rem; font-weight: bold;
                box-shadow: 0 4px 15px rgba(33, 115, 70, 0.4);
                cursor: pointer; border: none; z-index: 1000;
                display: flex; align-items: center; gap: 10px;
                width: 80%; justify-content: center; max-width: 350px;
            }
            .excel-fab:hover { background-color: #1e6b41; }

            .hidden { display: none; }
        </style>
    </head>
    <body>

        <header class="main-header">
            <h1>××¢×¨×›×ª ×”×¢×¨×›×ª ×ª×œ××™×“×™×</h1>
            <h2>×¢××•×ª×ª ×§×•×“×§×•×“</h2>
        </header>

        <div class="container">
            <div class="filter-box">
                <select id="branchSelect" onchange="loadMegama()">
                    <option value="">ğŸ¢ ×‘×—×¨ ×¡× ×™×£...</option>
                </select>
                <select id="classSelect" onchange="renderStudents()" disabled>
                    <option value="">ğŸ“ ×‘×—×¨ ××’××”...</option>
                </select>
            </div>

            <div id="students-container">
                <div style="text-align:center; padding: 40px; color:#999;">× × ×œ×‘×—×•×¨ ×¡× ×™×£ ×•××’××” ×›×“×™ ×œ×”×ª×—×™×œ</div>
            </div>
        </div>

        <button onclick="downloadExcel()" class="excel-fab hidden" id="downloadBtn">
            <span>×”×•×¨×“ ×§×•×‘×¥ ××§×¡×œ</span>
            <span style="font-size: 1.5em;">ğŸ“Š</span>
        </button>

        <script>
            const data = {"×¤×ª×— ×ª×§×•×”": {"×’×™××•××™× ×˜": [{"name": "××™×ª××¨ ×¢×“× ×™", "id": "325548766", "image": "images/2549041224_IMG-20250817-WA0141.jpg"}, {"name": "×‘× ×™×”×• ××œ×›×”", "id": "211885058", "image": "images/2549037093_IMG_20250326_114945_562 1.jpg"}, {"name": "××¨×™××œ ×¢××™×¨×”", "id": "325037935", "image": "images/2549035715_×¦×™×œ×•× ××¡×š 2025-12-02 201226.png"}, {"name": "×™×©×¨××œ ××œ×™××š", "id": "208091512", "image": "images/2549037091_IMG_5864.jpeg"}, {"name": "××¨×™ ×¨×•×˜", "id": "326375763", "image": "images/2549041157_563de6d9-4801-4c94-b35c-e5e64063aa07.jpeg"}, {"name": "× ×ª× ××œ ×–×™×œ×‘×¨××Ÿ", "id": "314622796", "image": "images/2549033413_IMG_6049.jpeg"}, {"name": "×™×“×™×“×™×” ×§×¨×™×¡×˜×œ", "id": "326593118", "image": "images/2549042715_×ª××•× ×ª ×¤×¡×¤×•×¨×˜ ×™×“×™×“×™×”.jpeg"}, {"name": "××¨×™×” ×›×”×Ÿ", "id": "213291511", "image": "images/2549037071_20250827_202023.heic"}], "×œ×œ× ××’××”": [{"name": "×™×•×¡×™ ×•×™×¡×‘×¨×’", "id": "323806554", "image": "images/2549035698_×¤×¡×¤×•×¨×˜.jpg"}], "×ª×›× ×•×ª 2 ×¤×ª": [{"name": "××œ×¢×–×¨ ×¢×¨× ×˜×¨×•×™", "id": "315640169", "image": "images/2549037069_×¦×™×œ×•× ××¡×š 2025-12-02 201426.png"}, {"name": "×™×”×•× ×ª×Ÿ ×§×•×‘×™", "id": "212402283", "image": "images/2549041145_20250819_123043.jpg"}, {"name": "×©××¢×•×Ÿ ×›×”×Ÿ", "id": "214684037", "image": "images/2549042557_Screenshot_20250818_142506_Gallery.jpg"}, {"name": "××™×¦×™×§ ×¤×¨×™×“××Ÿ", "id": "214992513", "image": "images/2549038710_20250808_085327.jpg"}, {"name": "××œ×¢×–×¨ ×§×¨××•×¡", "id": "325153526", "image": "images/2549042688_IMG-20240108-WA0030.jpg"}, {"name": "×¨××•×‘×Ÿ ×¨×•×–×Ÿ", "id": "227369451", "image": "images/2549033556_image.jpg"}, {"name": "××©×¨ ×¤×™×¨×•×‘", "id": "323816587", "image": "images/2549037002_××©×¨ ×¤×™×¨×•×‘.png"}, {"name": "××¨×™×” ×˜×•×œ× ×¤×œ×“", "id": "325554368", "image": "images/2549038640_20250831_232842.jpg"}, {"name": "×× ×—× ×›×”×Ÿ", "id": "315602011", "image": "images/2549037085_×ª××•× ×”.jpg"}, {"name": "×“×•×“ ×‘×Ÿ ×©×•×©×Ÿ", "id": "326618444", "image": "images/2549035629_IMG_1987.jpeg"}, {"name": "×©×™×œ×” ×•×§×¡×œ×¨", "id": "324825538", "image": "images/2549038554_IMG_3800.jpeg"}, {"name": "××¨×“×›×™ ×¤×¡×—", "id": "209560622", "image": "images/2549038654_17567501263157312177652076608661.jpg"}, {"name": "×¡×¢×¨ ×©××•××œ ××¤×¨×ª", "id": "325375293", "image": "images/2549035783_20250813_122531.jpg"}, {"name": "×‘× ×™ ×“×•×©×™× ×¡×§×™", "id": "214597155", "image": "images/2549041069_×‘× ×™.jpg"}, {"name": "×××™×¨ ×œ×‘×™×™×‘", "id": "326668639", "image": "images/2549036955_1122.jpg"}, {"name": "×™×¢×§×‘ ×‘×¨× ×˜", "id": "212222202", "image": "images/2549035796_IMG-20250831-WA0083.jpg"}, {"name": "×××™×¨ ×–×™×œ×‘×¨××Ÿ", "id": "212729099", "image": "images/2549041141_20250820_080252.jpg"}, {"name": "××•×©×™ ×¤×™×œ×™×¤", "id": "213496573", "image": "images/2549037007_WIN_20250813_07_34_30_Pro.jpg"}, {"name": "×™×¢×§×‘ ×§×•×¨×œ× ×¡×§×™", "id": "212129068", "image": "images/2549035676_20250821_173134.jpg"}, {"name": "×©×œ×•××™ ×—×™ ×©×¨×’×", "id": "316528140", "image": "images/2549035711_20250902_070755.jpg"}, {"name": "×™×•×¡×™ ×©×œ××¡", "id": "314886086", "image": "images/2549041221_×¤×¡×¤×•×¨×˜.JPG"}, {"name": "×“×•×“ ×¨×•×‘×™× ×©×˜×™×™×Ÿ", "id": "324252758", "image": "images/2549035798_×ª××•× ×ª ×¤×¨×•×¤×™×œ.jpg"}, {"name": "×‘× ×™××™×Ÿ ××‘×•×˜×‘×•×œ", "id": "214377392", "image": "images/2549035578_×¦×™×œ×•× ××¡×š 2025-12-02 203008.png"}, {"name": "××¨×“×›×™ ×›×”×Ÿ ×”×œ×¤×¨×™×Ÿ", "id": "212120109", "image": "images/2549035412_20250820_195148.jpg"}, {"name": "×©××©×™ ×¤×“×¨", "id": "318673027", "image": "images/2549035684_×ª××•× ×ª ×¤×¨×•×¤×™×œ.jpg"}, {"name": "××©×” ×™×¢×§×‘ ×–×™×œ×‘×¨", "id": "322929761", "image": "images/2549035706_IMG-20250915-WA0057.jpg"}, {"name": "××‘×¨×”× ××œ××œ×™×—", "id": "213120397", "image": "images/2549037152_20250825_195528.heic"}, {"name": "×©××¢×•×Ÿ ××‘×¨××¦×™×•×‘", "id": "325449064", "image": "images/2549035582_image.jpg"}, {"name": "××¤×¨×™× ×©×™×©×•", "id": "326638566", "image": "images/2549037067_image.jpg"}, {"name": "××”×¨×Ÿ ×’×¨×™× ×‘×¨×’×¨", "id": "214715351", "image": "images/2549035683_20250818_002502.jpg"}, {"name": "×× ×—× ×’×œ× ×¦×‘×¨×’", "id": "215068529", "image": "https://via.placeholder.com/150?text=No+Img"}], "×“××˜×” ×•×©×¤×”": [{"name": "××‘×¨×”× ×¨×•×–× ×‘×¨×’", "id": "212401871", "image": "images/2549036967_Screenshot_20250916-011357_Gallery.jpg"}, {"name": "×™×•×¡×£ ×¨×•×“×¨××Ÿ", "id": "315239707", "image": "images/2549035685_IMG_3447.jpeg"}, {"name": "× ×”×•×¨××™ ×’×•××˜×”", "id": "322433350", "image": "images/2549035580_IMG_20250828_143023934.jpg"}], "××œ×§×˜×¨×•× ×™×§×” ×¤×ª": [{"name": "××œ×™×”×• ×‘×©××¨×™", "id": "315242982", "image": "images/2549033422_20250818_152225.jpg"}, {"name": "××œ×™×”×• ×¡×¨×•×¨", "id": "325751329", "image": "images/2549042523_IMG_6879.jpeg"}, {"name": "××‘×™×©×™ ×××™×¨ ×•×”×‘", "id": "212816912", "image": "images/2549042646_×¦×™×œ×•× ××¡×š 2025-12-02 204145.png"}, {"name": "×“×•×“ × ×—×•×", "id": "322318932", "image": "images/2549042561_IMG_20251005_003953.jpg"}, {"name": "×™×©×¨××œ ×××™×¨ ××–×¨×—×™", "id": "326041704", "image": "images/2549033529_20250916_093717.jpg"}, {"name": "××©×” ×›×”×Ÿ", "id": "323054841", "image": "images/2549033674_Screenshot_20250814_022016_Gallery.jpg"}, {"name": "× ×¤×ª×œ×™ ×¦×‘×™ ×™×”×•×“×” ×‘×¨×œ×™×Ÿ", "id": "207294976", "image": "images/2549038694_IMG-20241230-WA00691.jpg"}, {"name": "××™×¦×™×§ ×‘×•×¨× ×©×˜×™×™×Ÿ", "id": "212758908", "image": "images/2549038676_20250821_172413.heic"}, {"name": "×™×©×¨××œ ××œ×‘×–", "id": "215126236", "image": "images/2549038805_20250828_1814591.jpg"}, {"name": "××¨×™××œ ×•×™×™×¡× ×©×˜×¨×Ÿ", "id": "325561520", "image": "images/2549038784_20250831_003017.jpg"}, {"name": "×™×”×•× ×ª×Ÿ ×œ×•×™", "id": "213140387", "image": "images/2549033530_20251109_165417.jpg"}, {"name": "××œ×—× ×Ÿ ×œ×•×™ ×©×›×˜×¨", "id": "318786282", "image": "images/2549033660_×ª××•× ×” ××œ×—× ×Ÿ.jpg"}, {"name": "×™×¢×§×‘ ×“×™×™×˜×©", "id": "327755005", "image": "images/2549042620_20250813_190127.jpg"}, {"name": "×©××¢×•×Ÿ ×™×¢×§×•×‘×•×‘", "id": "313244790", "image": "images/2549033376_unnamed.jpg"}, {"name": "× ×—×•× ×“×™×§××Ÿ", "id": "213277171", "image": "images/2549042599_1002667457.jpg"}], "××œ×§×˜×¨×•× ×™×§×” ×™×": [{"name": "×™×•×¡×£ ×œ×•×™", "id": "212961809", "image": "images/2549038737_17579285631937920901456925106726.jpg"}], "×ª×›× ×•×ª 1 ×¤×ª": [{"name": "×™×¢×§×‘ ×©×œ×•× × ×•×™×œ× ×“×¨", "id": "211594502", "image": "images/2549033669_image.jpg"}, {"name": "×™×©×¨××œ ×‘×™×¨× ×‘×¨×’", "id": "322446261", "image": "images/2549042563_IMG-20250915-WA0263.jpg"}, {"name": "×™×©×¨××œ ××©×” ×§×•×‘×™×˜×©×•×§", "id": "213427883", "image": "images/2549033380_20250828_224335.jpg"}, {"name": "××©×” ×—×¨×™×˜×Ÿ", "id": "214339822", "image": "images/2549037144_image.jpg"}, {"name": "××”×¨×•×Ÿ ×§×¦×‘×•×¨×’", "id": "322682246", "image": "images/2549033497_IMG-20250820-WA0081.jpg"}, {"name": "×©××•××œ ×”×•×¨×‘×™×¥", "id": "214378820", "image": "images/2549041066_IMG-20250818-WA0116.jpg"}, {"name": "×©×œ××” ×•×§×¡××Ÿ", "id": "326001591", "image": "images/2549035645_IMG-20250821-WA0015.jpg"}, {"name": "××œ×™ ×˜×¡×œ×¨", "id": "207647629", "image": "images/2549041151_×¦×™×œ×•× ××¡×š 2025-12-02 202345.png"}, {"name": "××©×¨ ×¦×‘×™ ×¤×œ×“××Ÿ", "id": "211431069", "image": "images/2549038655_image.jpg"}, {"name": "××‘×¨×”× ×¨×•×–× ×’×¨×˜×Ÿ", "id": "315857318", "image": "images/2549037003_image.jpg"}, {"name": "×™×¦×—×§ ××™×™×–×§ ×’×œ×™×§", "id": "213877301", "image": "images/2549038656_×ª××•× ×” ×œ×›×¨×˜×™×¡ ×¡×˜×•×“× ×˜.jpg"}, {"name": "×× ×—× ×××™×ª×™", "id": "213897697", "image": "images/2549041118_IMG_5950.jpeg"}, {"name": "××œ×¢×–×¨ ××œ×˜××Ÿ", "id": "213928401", "image": "images/2549038782_20250806_1909171.jpg"}, {"name": "×“×•×“ ××§×œ×‘", "id": "209303155", "image": "images/2549041218_20250817_171046.jpg"}, {"name": "×—×–×§×™ ××¨× ×¤×œ×“", "id": "327531331", "image": "images/2549037294_IMG-20250821-WA0196.jpg"}, {"name": "××‘×¨×”× ××™×¦×§×•×‘×™×¥", "id": "214180242", "image": "images/2549035646_×ª××•× ×” ×¤×¡×¤×•×¨×˜.JPG"}, {"name": "×™×¢×§×‘ ××•×—×™×•×Ÿ", "id": "208891580", "image": "images/2549035677_IMG-20250813-WA0248.jpg"}, {"name": "×©×œ××” ×‘×¨×•×š × ×•×™×¤×œ×“", "id": "322593807", "image": "images/2549041154_SIMSd620005_0002.jpg"}, {"name": "× ×ª×™ ×œ×™×× ×™", "id": "315548693", "image": "images/2549037065_IMG_7457.jpeg"}, {"name": "×—×™×™× ×™×”×•×“×™", "id": "214434995", "image": "images/2549041128_20250821_235603.jpg"}, {"name": "×—×™×™× ××™×œ×¨", "id": "326617107", "image": "images/2549038557_WIN_20250831_19_16_56_Pro.jpg"}, {"name": "× ×ª× ××œ ×‘×Ÿ ×–×§×Ÿ", "id": "324151414", "image": "images/2549035537_×ª××•× ×”.pdf"}, {"name": "× ×”×•×¨××™ ××’×•×¨×™", "id": "324953447", "image": "images/2549037291_IMG_3240.png"}, {"name": "×™×©×¨××œ ××©×” ×‘×¨××™× ×§×”", "id": "325019081", "image": "images/2549035799_20250506_10431811.jpg"}, {"name": "××”×¨×•×Ÿ ×¨×‘×”×•×Ÿ", "id": "211769187", "image": "images/2549035703_20250820_185247.png"}, {"name": "×—×™×™× ×™×¢×§×‘×¡×•×Ÿ", "id": "213396039", "image": "images/2549037290_×¦×™×œ×•× ××¡×š 2025-12-02 203042.png"}, {"name": "× ×ª× ××œ ××œ×™×—×™", "id": "315162099", "image": "images/2549033673_17557159604633373023101059013953.jpg"}, {"name": "×“×•×“ ×™××™×Ÿ", "id": "325959609", "image": "images/2549037089_Screenshot_20250831_092516_Gallery.jpg"}, {"name": "×©××•××œ ×¦×‘×™ ×§×•×‘×œ×¡×§×™", "id": "316334424", "image": "images/2549033634_image.jpg"}], "×¨×©×ª×•×ª": [{"name": "××”×¨×•×Ÿ ××™×™×–×™×§ ×•×™×™×¡××Ÿ", "id": "207142423", "image": "images/2549038670_17566680695027644326595349720279.jpg"}], "×ª×›× ×•×ª ×¤×˜×•×¨ ×¤×ª": [{"name": "× ×ª× ××œ ×§××¤×œ×™×Ÿ", "id": "325134666", "image": "images/2549038713_IMG_9786.jpeg"}, {"name": "×©××—×” ×§×•×¤×¨××Ÿ", "id": "212036511", "image": "images/2549038594_20250817_213710.jpg"}, {"name": "××‘×™ ×§×œ×™×™×Ÿ", "id": "323011379", "image": "images/2549041117_×¦×™×œ×•× ××¡×š 2025-12-02 201711.png"}, {"name": "×××™×¨ ×”×•×œ×¦×¨", "id": "208463869", "image": "images/2549042521_20250820_234615.jpg"}, {"name": "×™×¦×—×§ ×¨×•×‘×™×Ÿ", "id": "206913956", "image": "images/2549033424_×ª××•× ×”.jpeg"}, {"name": "×™×¢×§×‘ ×’×¨×™× ×‘×•×™×", "id": "324240860", "image": "images/2549036954_×ª××•× ×ª ×¤×¡×¤×•×¨×˜.jpg"}, {"name": "××‘×¨×”× ×œ×™×“×¨", "id": "327532131", "image": "images/2549033588_20250904_084737.heic"}, {"name": "××œ×™×¡×£ ××’×•×¨×™", "id": "212509699", "image": "images/2549037092_20251109_185724.jpg"}, {"name": "×™×”×•× ×ª×Ÿ ××‘×¨×”× ×“×“×•×Ÿ", "id": "212174403", "image": "images/2549038743_IMG_5074.jpeg"}, {"name": "××ª×ª×™×”×• ×œ×“×¨××Ÿ", "id": "207813288", "image": "images/2549042519_20250825_201232.jpg"}, {"name": "×—×™×™× ×©×•×•×¨×¥", "id": "214378234", "image": "images/2549035479_17579310922542425031441104857143.jpg"}, {"name": "××¨×“×›×™ ×‘×¨-×˜×œ", "id": "213917743", "image": "images/2549035695_20250822_114852.jpg"}, {"name": "××‘×™××œ ×§×“×", "id": "213054711", "image": "images/2549041223_photo_2025-08-19_14-53-47.jpg"}], "×ª×›× ×•×ª ×¤×˜×•×¨ ×™×": [{"name": "×™×¢×§×‘ ×–×™×’×œ×‘×•×™×", "id": "207897075", "image": "images/2549035581_×¦×™×œ×•× ××¡×š 2025-12-02 203217.png"}]}, "×™×¨×•×©×œ×™×": {"×’×™××•××™× ×˜": [{"name": "×¦×‘×™×§×” ×§×œ×™×™×Ÿ", "id": "324138999", "image": "images/2549035657_20240709_075645.heic"}, {"name": "××¨×“×›×™ ××™× ×§×•×‘×™×¥", "id": "323929968", "image": "images/2549037074_20250831_205116.jpg"}, {"name": "× ×ª× ××œ ××™×™×–× ×‘×šâ€¬â€", "id": "208830372", "image": "images/2549037019_×ª××•× ×” ×›×¨×˜×™×¡ ×¡×˜×•×“× ×˜.png"}, {"name": "×“×•×“ ×¦×‘×™ ×©×¤×™×¨×", "id": "325525475", "image": "images/2549041131_unnamed 23.jpg"}, {"name": "××©×” ×’×¨×‘×¨", "id": "209788793", "image": "images/2549035596_IMG_1966.jpeg"}, {"name": "×“×•×“ ×¦×‘×™ ×“×™×§", "id": "211489489", "image": "images/2549033531_1000352650 1.jpg"}, {"name": "××œ×™×”×• ×©×”×¨×‘× ×™", "id": "206760480", "image": "https://via.placeholder.com/150?text=No+Img"}, {"name": "× ×ª× ××œ ×’×œ×•×‘× ×¦×™×¥", "id": "326200409", "image": "images/2549038672_IMG_20250612_213118.jpg"}], "×“××˜×” ×•×©×¤×”": [{"name": "×‘× ×™ ×§×™×¡×˜×¨", "id": "315301564", "image": "images/2549041142_20250813_200345.jpg"}, {"name": "×™×¢×§×‘ ×¤×¨×¦×•×‘×¡×§×™", "id": "328115761", "image": "images/2549041130_17569228565664460644205353098255.jpg"}, {"name": "×™×¦×—×§ ×©×•×¤×¨", "id": "206668386", "image": "images/2549038637_×ª××•× ×ª ×¡×˜×•×“× ×˜.jpg"}, {"name": "××©×” ××œ×™×¢×–×¨ ×‘×œ×™×™×¨", "id": "213351257", "image": "images/2549037154_17561135862085252435229429118383.jpg"}], "×ª×›× ×•×ª 1 ×™×": [{"name": "××•×¨ ×¨×•×–×™×Ÿ", "id": "318877784", "image": "images/2549033698_20250820_222944.jpg"}, {"name": "××•×¨ ×—×™×™× ×× ×—× ×‘×Ÿ-×˜×•×‘", "id": "323787119", "image": "images/2549035723_IMG_3296.jpeg"}, {"name": "×™×”×•×“×” ×¡×™×•× ×•×‘", "id": "315208587", "image": "images/2549038787_×¦×™×œ×•× ××¡×š 2025-12-02 202518.png"}, {"name": "× ×ª×Ÿ ×‘×œ×“×•×˜", "id": "315244376", "image": "images/2549033568_IMG-20250817-WA0312.jpg"}, {"name": "××œ×—× ×Ÿ ×¨×•×–× ×‘×œ×•×", "id": "214661456", "image": "images/2549042611_20241028_120639.jpg"}, {"name": "××™×ª×™××œ ××œ×™×”×•", "id": "213813744", "image": "images/2549038638_e691e4fa-39cb-4d42-a7a2-dc3e54a81665.jpeg"}, {"name": "×¦×‘×™ ×‘×œ×•×™", "id": "213088610", "image": "images/2549033560_Screenshot_20250824_143811_WhatsApp.jpg"}, {"name": "×™×¢×§×‘ ×§×œ×•×’×¨", "id": "324953603", "image": "images/2549038779_20250825_215952.jpg"}, {"name": "×™×”×•×“×” ×™×“×œ×¨", "id": "315364273", "image": "images/2549038711_20250821_150316.jpg"}, {"name": "××©×” ×›×”×Ÿ", "id": "208756270", "image": "images/2549033551_×¦×™×œ×•× ××¡×š 2025-12-02 202444.png"}, {"name": "×× ×“×™ ×¨×™×™× ×™×¥", "id": "213358773", "image": "images/2549033567_IMG_6114.jpeg"}, {"name": "××œ×¢×–×¨ ×©×“××™", "id": "206593543", "image": "images/2549033538_IMG-20250817-WA0032.jpg"}, {"name": "×©×™×œ×” ×’×¨× ×•×ª", "id": "212055974", "image": "images/2549033494_3P5B8191 copy.jpg"}, {"name": "×“×•×“ ×©×˜×¨×™×™×›×¨", "id": "316289891", "image": "images/2549037147_×¦×™×œ×•× ××¡×š 2025-12-02 202253.png"}, {"name": "×©×œ××” ×©×•×‘", "id": "214872954", "image": "images/2549042584_42a5ea13-5c15-401d-a70f-d864ace13d56.jpeg"}, {"name": "××”×¨×Ÿ ×•×•×‘×¨", "id": "313282600", "image": "images/2549037146_×ª××•× ×” 19.8.2024 ×‘-9.05.jpeg"}, {"name": "××‘×™××œ ×›×”×Ÿ", "id": "207290248", "image": "images/2549036980_17627114174116022721750399776979.jpg"}, {"name": "×™×•××œ ×™×•×¡×™×œ×‘×™×¥'", "id": "325468916", "image": "images/2549036982_×ª××•× ×ª ×¤×¡×¤×•×¨×˜.jpg"}, {"name": "×“×•×“ ×¦×‘×™ ××•×¡×˜×¨×™", "id": "207320565", "image": "images/2549035576_Screenshot_20250817_181718_Samsung Notes.jpg"}, {"name": "×™×”×•×“×” ×“×¨××•×Ÿ", "id": "324499359", "image": "images/2549035480_×¦×™×œ×•× ××¡×š 2025-12-02 202139.png"}, {"name": "×™×•× ×” ××©×” ×—×™×•××”", "id": "332336932", "image": "images/2549035481_×¦×™×œ×•× ××¡×š 2025-12-02 202058.png"}, {"name": "×©××—×” ×–×™×¡×œ ×¡×’×œ", "id": "323058073", "image": "images/2549035538_×ª××•× ×” ×œ×›×¨×˜×™×¡.jpg"}, {"name": "××œ×™×¡×£ ×™×•×¡×£ ×•×™×¡××Ÿ", "id": "209300052", "image": "images/2549035712_file_00000000e5c461f5b304859aa366424a.png"}, {"name": "××‘×™×‘ ×“×¨×¢×™", "id": "322461765", "image": "images/2549033548_IMG_20241127_175424.jpg"}, {"name": "×™×¢×§×‘ ×©×œ×–×™× ×’×¨", "id": "213114465", "image": "images/2549041072_×¦×™×œ×•× ××¡×š 2025-09-03 232421.png"}, {"name": "×™×¢×§×‘ ×–×œ×¦××Ÿ", "id": "214346033", "image": "images/2549035704_IMG-20250821-WA0058 ×ª××•× ×”.jpg"}, {"name": "×™×¢×§×‘ ×•×™×–×œ", "id": "325087658", "image": "images/2549037149_file_000000001b4861f882969830f67d3188.png"}, {"name": "××©×” ×’×¨×˜× ×¨", "id": "213659196", "image": "images/2549035800_20250325_164956.jpeg"}, {"name": "×¨××•×‘×Ÿ ×¤×¨×§×œ", "id": "214337891", "image": "images/2549041073_gmail_images20250813_172612.jpg"}, {"name": "×™×¦×—×§ ×¨×™×™× ×¨", "id": "324863646", "image": "images/2549033549_×˜ ×.jpg"}, {"name": "××‘×¨×”× ×’×¨×•×¡", "id": "322690470", "image": "images/2549042596_×ª××•× ×” ×©×œ WhatsApp 2025-08-17 ×‘×©×¢×” 18.40.42_ac19df56.jpg"}, {"name": "×™×”×•×“×” ×‘×Ÿ ×“×™×™×Ÿ", "id": "208059949", "image": "images/2549042647_×¦×™×œ×•× ××¡×š 2025-12-02 201800.png"}, {"name": "×™××™×¨ ×©×¨×¢×‘×™", "id": "314668500", "image": "images/2549042689_WhatsApp Image 2025-11-12 at 17.25.11.jpeg"}], "××œ×§×˜×¨×•× ×™×§×” ×™×": [{"name": "××¨×™××œ ××‘×¨×”× ×’×¨×™× ×©×¤×Ÿ", "id": "214363582", "image": "images/2549038634_20250127_164655.jpg"}, {"name": "×™×”×•×“×” ××™×“×œ××Ÿ", "id": "325238517", "image": "images/2549042714_×¤× ×™×.PNG"}, {"name": "××”×¨×•×Ÿ ×¡×œ××•×Ÿ", "id": "324819879", "image": "images/2549042614_IMG-20250909-WA0001.jpg"}, {"name": "××‘×¨×”× ×™×¦×—×§ ×©×§×•×œ× ×™×§", "id": "315205963", "image": "https://via.placeholder.com/150?text=No+Img"}, {"name": "× ×ª× ××œ ×¨×•×–× ×¨", "id": "322590191", "image": "images/2549042531_IMG-20250501-WA0052.jpg"}, {"name": "× ×— ×¨×•×¡", "id": "332677020", "image": "images/2549033496_20250819_135916.jpg"}, {"name": "×™×•×¡×£ ×××™×¨ ×•×™× ×©×˜×•×§", "id": "345904809", "image": "images/2549037227_×¦×™×œ×•× ××¡×š 2025-12-02 202549.png"}, {"name": "×©××•××œ ×©×™×™× ×‘×¨×’", "id": "212412563", "image": "images/2549033544_×¦×™×œ×•× ××¡×š 2025-12-02 202919.png"}, {"name": "××œ×™×©×™×‘ ×¤×¨××•×™", "id": "325892776", "image": "images/2549038653_Screenshot_20250908-221840_101819.png"}, {"name": "××¨×™×” ××™×œ×¦×§×™", "id": "315174706", "image": "images/2549042642_IMG_7067.jpeg"}, {"name": "×™×”×•× ×ª×Ÿ ×‘×œ×•×š", "id": "321561987", "image": "images/2549033539_photo_2025-08-19_14-41-41.jpg"}, {"name": "×™×¢×§×‘ ××¡×§×•×¦×§×™", "id": "213236714", "image": "images/2549042552_IMG_4069.jpeg"}, {"name": "××”×¨×Ÿ ×œ×–×¨×•×‘×™×¥", "id": "324219781", "image": "images/2549038597_×ª××•× ×ª ×¡×˜×•×“× ×˜.JPG"}, {"name": "××‘×¨×”× ×¨×™×™×Ÿ", "id": "212044325", "image": "images/2549033562_×¦×™×œ×•× ××¡×š 2025-12-02 201610.png"}, {"name": "××©×” ×’×œ×™×§", "id": "212368161", "image": "images/2549038778_17557000308953094878452064250857.jpg"}, {"name": "×—× × ×™×” ××™×™×–×™×§×¡", "id": "327506945", "image": "images/2549042718_20250826_181410.jpg"}, {"name": "× ×ª× ××œ ×¤×¨×¥", "id": "328116579", "image": "images/2549038824_IMG_6945.jpeg"}, {"name": "×™×•×¡×£ ×“×•×™×“×–×•×Ÿ", "id": "326594215", "image": "images/2549038733_17579262109797325362027112028549.jpg"}, {"name": "×©×œ×•× ×¡×¤×¨×™×Ÿ", "id": "314818527", "image": "images/2549038636_20250818_145205.jpg"}, {"name": "×™×”×•×“×” ××§×¨××Ÿ", "id": "214120354", "image": "images/2549042619_IMG_5703.jpeg"}, {"name": "×¨×¤××œ ×›×¥", "id": "347532087", "image": "images/2549033462_image.jpg"}, {"name": "××©×” ×¤×œ×™× ×˜× ×©×˜×™×™×Ÿ", "id": "325302537", "image": "images/2549033541_× ×¤.jpg"}, {"name": "×™×•×¡×£ ×—×™×™× × ×•×¨× ×™", "id": "326038528", "image": "images/2549033614_IMG_20250820_195321.jpg"}, {"name": "×©×œ×•× ××™× ×¡", "id": "213205321", "image": "images/2549033423_20250825_184036.jpg"}, {"name": "××¨×“×›×™ ××©×›× ×–×™", "id": "211749932", "image": "images/2549033463_20250822_162931.jpg"}, {"name": "××œ×™×”×• ×‘× ×™××™×Ÿ ×’×•×¨", "id": "314818659", "image": "images/2549042583_1dd8e3d9-c523-41e0-a352-6bed69587d0f.jpeg"}, {"name": "×™×”×•×“×” ×™×“×œ×¨", "id": "212365720", "image": "images/2549033594_20250114_141329_2.png"}, {"name": "×©×œ××” ××©×”", "id": "315131706", "image": "images/2549042560_IMG-20250401-WA0008 1.jpg"}], "×ª×›× ×•×ª 2 ×™×": [{"name": "× ×ª×™ ×§×œ×™×™×Ÿ", "id": "322244112", "image": "images/2549038675_IMG-20250902-WA0047.jpg"}, {"name": "×™×”×•×“×” ×—×“×“", "id": "213689334", "image": "images/2549033593_IMG_9642.jpeg"}, {"name": "×©×œ××” ×¤×™×™×˜", "id": "315445726", "image": "images/2549035628_photo_2025-08-20_13-48-46.jpg"}, {"name": "× ×™×¡×™× ××”×¨×•× ×•×‘", "id": "329606149", "image": "images/2549038652_20250824_200545.jpg"}, {"name": "××‘×¨×”× ×©×˜×¨× ×‘×¨×’", "id": "322675984", "image": "images/2549033408_IMG_20240428_085221_361.jpg"}, {"name": "××”×¨×•×Ÿ ×§×“×¨", "id": "212626303", "image": "images/2549037016_×¦×™×œ×•× ××¡×š 2025-12-02 202215.png"}, {"name": "×“× ×™×œ ×—×‘×¨×—× ×•×‘", "id": "347566739", "image": "images/2549037084_17555073637581359879459011238270.jpg"}, {"name": "×¢×–×¨× ×§×™×¡×•×¡", "id": "339810533", "image": "images/2549042517_IMG-20250819-WA0082.jpg"}, {"name": "× ×ª× ××œ ×”×œ×¨", "id": "325954196", "image": "images/2549037052_Screenshot_20250817_165255_Photos.jpg"}, {"name": "×™×©×¨××œ ×’×•×˜×©×˜×™×™×Ÿ", "id": "212217129", "image": "images/2549037148_IMG_20250821_235753.jpg"}, {"name": "×œ×•×™ ×™×¦×—×§ ×©×›×˜×¨", "id": "214431371", "image": "images/2549038606_IMG_5411.jpeg"}, {"name": "××”×¨×Ÿ ×¤×¨×™×“××Ÿ", "id": "322740259", "image": "images/2549042613_1762774747012291449881357696698.jpg"}, {"name": "×©××•××œ ×™×•×¡×£ ×¤×¨×œ××Ÿ", "id": "214385130", "image": "images/2549037087_foto face.jpg"}, {"name": "×™×¦×—×§ ×•×•×™× ×¢×¨", "id": "327121620", "image": "images/2549035644_×¦×™×œ×•× ××¡×š 2025-12-02 203139.png"}, {"name": "××‘×¨×”× ×“×•×“ ×§×™×¤×¨", "id": "207505819", "image": "images/2549035720_IMG-20250817-WA0018.jpg"}, {"name": "×œ×•×™ ×™×¦×—×§ ×•×•×œ×§×•×‘", "id": "209931245", "image": "images/2549036953_20250815_112136.jpg"}, {"name": "×“×•×“ ×××™×¨", "id": "206479776", "image": "images/2549035675_20250825_220708.jpg"}, {"name": "×©× ×™××•×¨ ×–×œ××Ÿ ×”×¨×¦×œ", "id": "214189045", "image": "images/2549038688_image.jpg"}, {"name": "××©×” ×‘×¨×˜×•×Ÿ", "id": "326131067", "image": "images/2549033613_27064ffc-a3bf-4c03-83b9-62929ba8af1d_20250819_175104_0000.png"}, {"name": "××‘×¨×”× ×¨×¤×¤×•×¨×˜", "id": "213292980", "image": "images/2549035482_17550813346352222122739918083499.jpg"}, {"name": "×“×•×“ ×¨×•×‘× ×™×¥", "id": "325909778", "image": "images/2549037008_IMG_20250816_221045.jpg"}, {"name": "×× ×—× ×¡×•×“×§×‘×™×¥", "id": "322271214", "image": "images/2549035678_20250815_003210.jpg"}, {"name": "×“×•×“ ×©×˜×¨×Ÿ", "id": "322382722", "image": "images/2549042553_×ª××•× ×” ×“×•×“ ×©×˜×¨×Ÿ.jpg"}, {"name": "×™×©×¨××œ ×–××‘ ×¨×™×™× ×¨", "id": "212727390", "image": "images/2549041219_×¦×™×œ×•× ××¡×š 2025-12-02 202023.png"}, {"name": "××œ×—× ×Ÿ ×–××‘ ×”×œ×¤×¨×™×Ÿ", "id": "325481968", "image": "images/2549033379_20250821_174018.jpg"}, {"name": "×™×”×•×©×¢ ×•×•×™×™×¡", "id": "322651563", "image": "images/2549037150_IMG_3908.jpeg"}, {"name": "×™×¢×§×‘ ×’×œ×•×‘×¨", "id": "345810329", "image": "images/2549035647_IMG_8957.jpg"}, {"name": "××œ×¢×–×¨ ×©×•×¨", "id": "207835794", "image": "images/2549036956_IMG-20250828-WA0003.jpg"}, {"name": "×©×¢×™'×” ×©× ×•×¨", "id": "212312060", "image": "images/2549038657_4.jpg"}, {"name": "××‘×¨×”× ×™×—×™××œ ×‘×¨×•×›×™×", "id": "213288061", "image": "images/2549035411_IMG-20250306-WA0070.jpg"}, {"name": "×¤× ×—×¡ ××§×¨××Ÿ", "id": "214378200", "image": "images/2549042562_WIN_20250414_17_03_06_Pro.jpg"}, {"name": "×™×•× ×ª×Ÿ ××™×™×¤×¨××Ÿ", "id": "325735595", "image": "images/2549038709_IMG-20250916-WA0044.jpg"}, {"name": "×™××™×¨ ×‘×Ÿ ×¦×•×¨", "id": "211779707", "image": "images/2549035579_YAIR___MIRYAM_34.jpg"}, {"name": "××¨×™××œ ×œ×•×™", "id": "326023215", "image": "images/2549042687_×¦×™×œ×•× ××¡×š 2025-12-02 201900.png"}, {"name": "×××™×¨ ×¨×•×›×œ×™×Ÿ", "id": "326057999", "image": "images/2549037068_1756587790034.jpg"}, {"name": "× ×—××Ÿ ×‘×•×¨×©×˜×™×™×Ÿ", "id": "322638693", "image": "images/2549038659_IMG_0340.JPG"}, {"name": "×™×”×•×“×” ×˜××¡×˜×˜", "id": "770324671", "image": "images/2549035682_image.jpg"}, {"name": "× ×ª×Ÿ ×‘×¨× ×”×•×œ×¥", "id": "207964537", "image": "images/2549042564_IMG-20250804-WA0057.jpg"}, {"name": "××”×¨×Ÿ ×¡×œ××•×Ÿ", "id": "318750601", "image": "images/2549033561_20250817_163033.jpg"}], "×ª×›× ×•×ª ×¤×˜×•×¨ ×™×": [{"name": "××•×¨×™ ×™×©×¨××œ ×œ×•×™× ×©×˜×™×™×Ÿ", "id": "325406072", "image": "images/2549042616_IMG_8492.jpeg"}, {"name": "×¨×¤××œ ××•×—×™×•×Ÿ", "id": "207459512", "image": "images/2549042719_×›×¨×˜×™×¡ ×¡×˜×•×“× ×˜.jpg"}, {"name": "××™×ª×Ÿ ××œ×›×”", "id": "214984288", "image": "https://via.placeholder.com/150?text=No+Img"}, {"name": "××œ×™ ××¨××œ×©×˜×™×™×Ÿ", "id": "347663684", "image": "images/2549042627_IMG_4863.jpeg"}, {"name": "××”×¨×•×Ÿ ×¤×¨×œ", "id": "212043483", "image": "images/2549033536_20250818_105228.jpg"}, {"name": "××œ×—× ×Ÿ ×©×˜×¨××•×¡", "id": "214942872", "image": "images/2549037051_IMG_3292.jpeg"}, {"name": "×”×œ×œ ×—×“×“", "id": "329676183", "image": "images/2549041071_image.jpg"}, {"name": "××œ×¢×–×¨ ×§××¤×œ×™×Ÿ", "id": "325585826", "image": "images/2549033633_IMG_8175.jpeg"}, {"name": "×”×œ×œ ××”×¨×•× ×™", "id": "325444164", "image": "images/2549038706_IMG_20251109_134638.jpg"}, {"name": "××™×›××œ ×©×œ×•×©", "id": "347533747", "image": "images/2549041092_WhatsApp Image 2025-08-25 at 8.21.26 PM 1.jpeg"}], "×¨×©×ª×•×ª": [{"name": "×™×•×¡×£ ×©×§×œ×™×", "id": "328175419", "image": "images/2549033447_17627162257307879114335425550258.jpg"}], "×ª×›× ×•×ª": [{"name": "×”×œ×œ ×§×“×¨", "id": "325573491", "image": "images/2549035485_Untitled design.png"}], "×ª×›× ×•×ª ×“×¨×•×": [{"name": "××©×” ×¤×•×’×œ", "id": "213361066", "image": "images/2549035594_×¦×™×œ×•× ××¡×š 2025-12-02 184431.png"}]}, "×›×œ×œ×™": {"×ª×›× ×•×ª ×¤×˜×•×¨ ×™×": [{"name": "×¨×•×Ÿ ××©×” ××¡×•×¡", "id": "347740219", "image": "images/2549038658_IMG_20251109_135216.jpg"}]}};
            const criteria = ["×¨××ª ××•×˜×™×‘×¦×™×”", "×¢××™×“×” ×‘× ×”×œ×™×", "×§×‘×œ×ª ×¡××›×•×ª", "×”×‘× ×ª ×—×•××¨ ×”×œ×™××•×“", "×©×•××œ ×©××œ×•×ª ×”×‘× ×”", "×™×›×•×œ×ª ×œ××™×“×” ×¢×¦××™×ª", "×¡×§×¨× ×•×ª", "×™×›×•×œ×ª ×œ×§×‘×œ ×‘×™×§×•×¨×ª", "××’×“×™×œ ×¨××©", "×“×™×¨×•×’ ×‘×™×—×¡ ×œ×›×™×ª×”"];

            const branchSel = document.getElementById('branchSelect');
            const classSel = document.getElementById('classSelect');
            const container = document.getElementById('students-container');
            const downloadBtn = document.getElementById('downloadBtn');

            window.onload = () => {
                Object.keys(data).sort().forEach(b => branchSel.add(new Option(b, b)));
            };

            function loadMegama() {
                const branch = branchSel.value;
                classSel.innerHTML = '<option value="">ğŸ“ ×‘×—×¨ ××’××”...</option>';
                classSel.disabled = true;
                downloadBtn.classList.add('hidden');
                container.innerHTML = '<div style="text-align:center; padding:20px;">× × ×œ×‘×—×•×¨ ××’××”</div>';

                if (branch && data[branch]) {
                    Object.keys(data[branch]).sort().forEach(m => classSel.add(new Option(m, m)));
                    classSel.disabled = false;
                }
            }

            function renderStudents() {
                const branch = branchSel.value;
                const megama = classSel.value;
                container.innerHTML = '';

                if (!branch || !megama) return;

                downloadBtn.classList.remove('hidden'); 
                const students = data[branch][megama];
                students.sort((a, b) => a.name.localeCompare(b.name));

                students.forEach(st => {
                    const noteKey = `note_${st.id}`;
                    const hasNote = localStorage.getItem(noteKey);

                    let criteriaHtml = '<div class="rating-section">';
                    criteria.forEach((crit, idx) => {
                        const radioName = `rate_${st.id}_${idx}`;
                        let options = '';
                        for (let i = 1; i <= 6; i++) {
                            options += `<label class="radio-group"><input type="radio" name="${radioName}" value="${i}" onchange="save(this, '${st.id}')"><span class="circle-btn">${i}</span></label>`;
                        }
                        options += `<label class="radio-group"><input type="radio" name="${radioName}" value="NA" onchange="save(this, '${st.id}')"><span class="circle-btn na-btn">×œ× × ××“×“</span></label>`;
                        criteriaHtml += `<div class="rating-row"><span class="rating-label">${crit}</span><div class="rating-options">${options}</div></div>`;
                    });
                    criteriaHtml += '</div>';

                    container.insertAdjacentHTML('beforeend', `
                        <div class="student-card ${hasNote ? 'filled' : ''}" id="card_${st.id}">
                            <div class="card-header">
                                <img src="${st.image}" class="student-img" loading="lazy" onerror="this.src='https://via.placeholder.com/70?text=No+Img'">
                                <div class="info"><h3>${st.name}</h3><p>${st.id}</p></div>
                            </div>
                            ${criteriaHtml}
                            <div class="note-area">
                                <textarea id="${noteKey}" placeholder="×”×¢×¨×” ×›×œ×œ×™×ª..." oninput="save(this, '${st.id}')"></textarea>
                            </div>
                        </div>
                    `);

                    // ×©×—×–×•×¨
                    if (localStorage.getItem(noteKey)) document.getElementById(noteKey).value = localStorage.getItem(noteKey);
                    criteria.forEach((_, idx) => {
                        const rName = `rate_${st.id}_${idx}`;
                        const val = localStorage.getItem(rName);
                        if (val) {
                            const rb = document.querySelector(`input[name="${rName}"][value="${val}"]`);
                            if (rb) rb.checked = true;
                        }
                    });
                });
            }

            function save(el, id) {
                localStorage.setItem(el.name || el.id, el.value);
                const card = document.getElementById('card_' + id);
                card.classList.add('filled');
            }

            // --- ×”×¤×•× ×§×¦×™×” ×œ×™×¦×™×¨×ª ××§×¡×œ ---
            function downloadExcel() {
                const branch = branchSel.value;
                const megama = classSel.value;
                const students = data[branch][megama];

                // ×”×›× ×ª ×”× ×ª×•× ×™× ×œ××§×¡×œ
                const excelRows = [];

                students.forEach(st => {
                    // ×‘×“×™×§×” ×”×× ×™×© ××™×“×¢ ×¢×œ ×”×ª×œ××™×“
                    let hasData = false;

                    // ××•×‘×™×™×§×˜ ×‘×¡×™×¡ ×œ×©×•×¨×”
                    const row = {
                        "×©× ×”×ª×œ××™×“": st.name,
                        "×ª×¢×•×“×ª ×–×”×•×ª": st.id,
                        "×¡× ×™×£": branch,
                        "××’××”": megama
                    };

                    // ×”×•×¡×¤×ª ×”×¦×™×•× ×™×
                    criteria.forEach((crit, idx) => {
                        const val = localStorage.getItem(`rate_${st.id}_${idx}`);
                        row[crit] = val ? val : ""; // ×× ××™×Ÿ ×¦×™×•×Ÿ ×©×™× ×¨×™×§
                        if (val) hasData = true;
                    });

                    // ×”×•×¡×¤×ª ×”×¢×¨×”
                    const note = localStorage.getItem(`note_${st.id}`);
                    row["×”×¢×¨×•×ª"] = note ? note : "";
                    if (note) hasData = true;

                    // ×”×•×¡×¤×” ×œ××§×¡×œ ×¨×§ ×× ×™×© ××™×“×¢ (××• ×©×¨×•×¦×™× ××ª ×›×•×œ× ×‘×›×œ ××§×¨×” - ×›×¨×’×¢ ×”×•×¡×¤×ª×™ ××ª ×›×•×œ×)
                    excelRows.push(row);
                });

                if (excelRows.length === 0) {
                    alert("××™×Ÿ × ×ª×•× ×™× ×œ×”×•×¨×“×”.");
                    return;
                }

                // ×™×¦×™×¨×ª ×’×œ×™×•×Ÿ ×¢×‘×•×“×”
                const ws = XLSX.utils.json_to_sheet(excelRows);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "×“×•×— ×”×¢×¨×›×”");

                // ×©××™×¨×ª ×”×§×•×‘×¥
                const fileName = `×“×•×—_×”×¢×¨×›×”_${branch}_${megama}.xlsx`;
                XLSX.writeFile(wb, fileName);
            }
        </script>
    </body>
    </html>
    